<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>お問い合わせ | FAQセンター</title>
  <link rel="stylesheet" href="assets/app.css" />
  <style>
    .card{max-width:720px;margin:24px auto;padding:20px;border-radius:16px;border:1px solid #eee;background:#fff;box-shadow:0 4px 18px rgba(0,0,0,.04)}
    .row{display:grid;gap:10px}
    .row input,.row textarea{width:100%}
    .hero{max-width:720px;margin:24px auto}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container" style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
      <div class="brand">
        <div class="title">FAQセンター</div>
        <div class="subtle">早稲田アカデミーシンガポール校</div>
      </div>
      <nav class="foot-actions" style="display:flex;gap:8px;">
        <a class="btn ghost" href="index.html">入口</a>
        <a class="btn ghost" href="faq.html">カテゴリ検索</a>
        <a class="btn ghost" href="search.html">キーワード検索</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="hero">
      <h1 style="margin:0 0 6px">お問い合わせ</h1>
      <p class="note">該当するFAQが見つからない場合のみご利用ください。送信内容は自動記録され、担当へ通知されます。</p>
    </div>

    <section class="card">
      <form id="inqForm" class="row" onsubmit="return false;">
        <input id="inqName"  placeholder="お名前（任意）" />
        <input id="inqMail"  placeholder="メールアドレス（任意）" />
        <input id="inqCat"   placeholder="カテゴリ（任意）" />
        <textarea id="inqMsg" placeholder="お問い合わせ内容" rows="5" required></textarea>
        <button id="inqSend" class="btn" type="button">送信</button>
      </form>
      <p id="inqNote" class="muted" style="margin-top:10px"></p>
    </section>
  </main>

  <footer class="site-footer">© Waseda Academy Singapore.</footer>

  <script src="assets/ai.js"></script> <!-- なくても可。読むだけなら未使用 -->
  <script>
    (async function(){
      const endpoint = window.CONFIG?.APPS_SCRIPT_ENDPOINT || window.APPS_SCRIPT_ENDPOINT;
      const btn  = document.getElementById('inqSend');
      const note = document.getElementById('inqNote');
      if(!btn){ return; }

      // 送信先の案内（Configが取れたら表示）
      try{
        if (endpoint){
          const r = await fetch(endpoint);
          const j = await r.json();
          if (j?.config?.CONTACT_EMAIL){
            note.textContent = `送信先: ${j.config.CONTACT_EMAIL}（送信内容は自動記録されます）`;
          }
        }
      }catch{}

      btn.addEventListener('click', async ()=>{
        const data = {
          fromName:  document.getElementById('inqName').value.trim(),
          fromEmail: document.getElementById('inqMail').value.trim(),
          category:  document.getElementById('inqCat').value.trim(),
          message:   document.getElementById('inqMsg').value.trim(),
        };
        if (!endpoint){ note.textContent = '送信先が未設定です（APPS_SCRIPT_ENDPOINT）。'; return; }
        if (!data.message){ note.textContent = 'お問い合わせ内容を入力してください。'; return; }

        try{
          const res = await fetch(endpoint, {
            method:'POST', headers:{'Content-Type':'application/json'},
            body: JSON.stringify(data)
          });
          const j = await res.json();
          if (j.ok){ note.textContent = '送信しました。担当より返信いたします。'; document.getElementById('inqForm').reset(); }
          else { note.textContent = '送信に失敗しました。時間をおいて再試行してください。'; }
        }catch{ note.textContent = '送信に失敗しました（通信エラー）。'; }
      });
    })();
  </script>
</body>
</html>
